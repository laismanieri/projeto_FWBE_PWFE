package br.senai.sp.cadastro.dao;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

import br.senai.sp.cadastro.model.Cadastro;

@Repository
public class CadastroDao {
	
    @Autowired
    JdbcTemplate  jdbcTemplate;

	public List<Cadastro> listarTodos() {
	    String sql = "SELECT id, descricao, preco FROM cliente";
	     
	    List<Cadastro> lista = jdbcTemplate.query(sql,
	                BeanPropertyRowMapper.newInstance(Cadastro.class));

		return lista;
	}
	
	
	public Cadastro pegarPorId(int id) {
		
	    String sql = "SELECT id, descricao, preco FROM cliente WHERE id=?";
	    
		Object[] params = {id};
	    
		Cadastro produto = jdbcTemplate.queryForObject(sql,
	        BeanPropertyRowMapper.newInstance(Cadastro.class), params);
	    
		return produto;
	}
	
	public Integer novo(Cadastro cadastro) {
		
        String sql = "INSERT INTO produtos (nome, cpf, email, telefone, dataNascimento, genero, estadoCivil, profissao) "
        		+ "VALUES (?, ?, ?, ?, ?, ?, ?, ?)";
        int result = jdbcTemplate.update(sql, 
        		cadastro.getNome(),
        		cadastro.getCpf(),
        		cadastro.getEmail(),
        	    cadastro.getTelefone(),
        	    cadastro.getDataNascimento(),
        	    cadastro.getGenero(),
        	    cadastro.getEstadoCivil(),        	  	
        	    cadastro.getProfissao()
        		);
		
		return result;
	}
	
	public int editar(Cadastro cadastro, int id) {
		String sql = "UPDATE produtos SET nome=?, cpf=?, email=?, telefone=?, dataNascimento=?, genero=?, estadoCivil=?, profissao=? WHERE id=?";
		
	    Object[] params = {cadastro.getNome(),
        		cadastro.getCpf(),
        		cadastro.getEmail(),
        	    cadastro.getTelefone(),
        	    cadastro.getDataNascimento(),
        	    cadastro.getGenero(),
        	    cadastro.getEstadoCivil(),        	  	
        	    cadastro.getProfissao(), 
        	    id};
	    
	    int result = jdbcTemplate.update(sql, params);
	     
		return result;
	}
	
	public int deletar(int id) {
		
		String sql = "DELETE FROM cliente WHERE id=?";
		
		Object[] params = {id};
		
		int result = jdbcTemplate.update(sql, params);
		
		return result;
	}
	
	
}